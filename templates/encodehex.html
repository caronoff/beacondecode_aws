{% extends "layout.html" %}
{% block title %}Decoded Beacon {% endblock %}
{% block head %}
  {{ super() }}
<!-- Custom styles for this template -->

    <link href="{{ url_for('static', filename='css/custom.css') }}" rel="stylesheet">
    <link href='https://fonts.googleapis.com/css?family=Montserrat:400,700' rel='stylesheet' type='text/css'>

{% endblock %}
{% block content %}





 <form id="genform" class="form-inline" style="width:600px" role="form">
       <div class="form-group"  >
            <label class="control-label">Beacon Generation: </label>
       </div>
<div class="form-group" >
      <div class="radio">
        <label class="radio-inline control-label"><input type="radio" name="optgen" id="gen_1" value="1" >First (T.001)</label>
      </div>
</div>

<div class="form-group" >
      <div class="radio">
        <label class="radio-inline control-label"><input type="radio" name="optgen"  id="gen_2" value="2">Second (T.018)</label>
      </div>
</div>
</form>




<form id="beacontype" class="form-inline" role="form" style="width:800px">
    <div class="form-group">
            <label class="control-label">Beacon:</label>
       </div>

    <div class="form-group">
      <div class="radio">
        <label class="radio-inline control-label"><input type="radio" name="beacontype" value="ELT" >ELT</label>
      </div>
    </div>

    <div class="form-group">
      <div class="radio">
        <label class="radio-inline control-label"><input type="radio" name="beacontype" value="EPIRB" >EPIRB</label>
      </div>
    </div>

    <div class="form-group">
      <div class="radio">
        <label class="radio-inline control-label"><input type="radio" name="beacontype" value="PLB" >PLB</label>
      </div>
    </div>

    <div class="form-group">
      <div class="radio">
        <label class="radio-inline control-label"><input type="radio" name="beacontype" value="TEST" >Test/Spare</label>
      </div>
    </div>

      <label for="protocol">Protocol:</label>
                        <select id="protocol" name="protocol" class="form-control">
                              <option value="001">Mustard</option>
                              <option value="010">Ketchup</option>
                              <option value="011">Relish</option>
                            </select>   


    <input type="text" style="visibility: hidden" name="country" id="ctry">
</form>

 <form id='countryForm' name="test" action="#">
            <!--<div class="form-group" id="combo-group"><label for="combo">Initial select</label><select id="combo" name="fruit" class="my-combo" data-btn-class="btn-success">
            {% for country in countries %} <option value="{{country}}">{{country}}</option>{% endfor %} </select>  </div>            -->
        <div class="ui-widget" style="margin:25px;">
          <label for="tags">Country: </label>
          <input id="tags">
        </div>
</form>



          <div id="pieces">



              <form id="genformpanel" class="form-inline" role="form">
                <div id="1" style="display: none;" class="panel panel-default">
                    <div class="panel-heading">First-generation beacon identification:</div>

                    <div class="panel-body">
                      <label for="input1">Input for first gen:</label>
                      <input type="text" class="form-control" name="input1" id="input1">
                        <label for="input3">Input for first gen:</label>
                      <input type="text" class="form-control" name="input3" id="input3">
                    </div>
                </div>
                <div id="2" style="display: none;" class="panel panel-default">
                    <div class="panel-heading">Second-generation beacon identification</div>
                    <div class="panel-body">
                        <label for="input2">Input for second gen:</label>
                        <input type="text" class="form-control" name="input2" id="input2">
                    </div>
                </div>
              </form>
        </div>











<div class="btn-toolbar" id="process">
        <a href="#" class="btn btn-success" id="done" style="margin-top: auto ; display:block; text-align: center">
          <span class="glyphicon glyphicon-ok" style="color:gray"></span> Done
        </a><div id="decoded"></div>
        </div>

{% endblock %}


{% block scripts %}
{{super()}}
<script src="{{ url_for('static', filename='js/bootstrap-combobox.min.js') }}"></script>

<script type="text/javascript">
    var newOptions = {"Option 1": "value1",
  "Option 2": "value2",
  "Option 3": "value3"
};

var $el = $("#protocol");
$el.empty(); // remove old options
$.each(newOptions, function(key,value) {
  $el.append($("<option></option>")
     .attr("value", value).text(key));
});




</script>
<script type="text/javascript">
$("#done").click(function() {
  var n_input = $('#input1').val();
  var ctry=$('#ctry').val();
  console.log(n_input,ctry);
  $.getJSON($SCRIPT_ROOT+'/processhex',  $('form').serialize(),function(data){
            if(data.echostatus=='valid'){
                console.log(data.returndata);
                $('#decoded').text(data.returndata);}
            else {
            $('#decoded').text(data.echostatus);
            }
                });
});
</script>

<script type="text/javascript">
$('#combo').on('change', function() {
$(".debug > .selected").text(this.value);
});

</script>

<script type="text/javascript">
$('#genform input').on('change', function() {
   var panelselect = $('input[name=optgen]:checked', '#genform').val();
    console.log(panelselect);
   if(panelselect=='1'){
        $('#1').show();
        $('#2').hide();}
    if(panelselect=='2'){
         $('#2').show();
         $('#1').hide();
}
});
</script>

<script type="text/javascript">
$('#beacontype input').on('change', function() {
   var btype = $('input[name=beacontype]:checked', '#beacontype').val();
    console.log(btype);
});
</script>



<script>
  $( function() {
    $( "#tags" ).autocomplete({
      source: function(request, response) {
            $.getJSON("{{url_for('autocomplete')}}",{
                q: request.term, // in flask, "q" will be the argument to look for using request.args
            }, function(data) {
                response(data.matching_results); // matching_results from jsonify
            });
        },
        minLength: 2,
        select: function(event, ui) {
            var country = ui.item.value
            console.log(country);
             $('input[name="country"]').val(country);
        }
      });
  });
  </script>




{% endblock %}

